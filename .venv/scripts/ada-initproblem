#!/usr/bin/env python3
import os
from sys import argv

# Constants
ADAENVVAR = "ADAVENVSET"
DOWNLOAD_URL = "https://aceptaelreto.com/pub/problems/v00{0}/{1}/sam/sample{2}.zip"
GET_URL = lambda p: DOWNLOAD_URL.format(p[0], p[1:], p)
COMMANDS = \
"""mkdir p{:0} 
wget "{1}"
mv sample{0}.zip p{0}
cd p{0}
unzip sample{0}.zip
mv sample{0}/* .
rm -r sample{0}*
"""

# Check if ada is set
if not os.environ.get("ADAVENVSET"):
    print(f"start the virtual enviroment first")

# Check if args are correct
if len(argv) not in (2, 3):
    print(f"{argv[0]} <problem n> [input type]")

problemn = argv[1]
inputtype = 0 if len(argv) == 2 else int(argv[2])

## Do everything
# Make folder, download, move, extract, move samples, delete
os.system(f"mkdir p{problemn}") 
os.system(f"wget \"{GET_URL(problemn)}\"")
os.system(f"mv sample{problemn}.zip p{problemn}")
os.chdir(f"p{problemn}")
os.system(f"unzip sample{problemn}.zip")
os.system(f"rm -r sample{problemn}.zip")

# Copy template
os.system(f"cp ${ADAENVVAR}/templates/input{inputtype}.c main.c")
os.system(f"cp ${ADAENVVAR}/templates/makefile makefile")

